Original Niave Attention,,,,,,,,,,,,,,,,,,,
O2 optimization,,,,,,,,,,,,,,,,,,,
d\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
16,0.0042,0.022,0.0904,0.3318,1.5768,6.8576,40.02,162.1,670.62,,,,,,,,,,
32,0.0103,0.0412,0.1332,0.6321,2.6599,16.43,93.328,396.27,1627.9,,,,,,,,,,
64,0.0181,0.0647,0.2708,1.1935,7.0365,34.572,203.01,831.28,3382.4,,,,,,,,,,
128,0.0371,0.1378,0.5592,4.1393,16.453,73.57,464.1,1898.1,7932.7,,,,,,,,,,
256,0.0703,0.2888,1.6065,8.2797,34.153,149.78,948.08,3887.9,16167,,,,,,,,,,
512,0.1391,0.884,4.4819,19.782,78.609,336.29,2102.6,9890.1,48714,,,,,,,,,,
1024,0.4293,2.6873,12.335,58.524,243.94,1051.7,6874,35426,156813,,,,,,,,,,
2048,1.0774,5.3099,25.092,124.84,539.72,2334.4,17260,84200,349356,,,,,,,,,,
4096,1.8987,11.289,51.551,250.54,1080.2,5526.6,38278,177362,732453,,,,,,,,,,
O3 optimization,,,,,,,,,,,,,,,,,,,
d\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
16,0.0052,0.0182,0.0843,0.3085,1.4593,6.2532,37.458,153.1,615.31,,0.8076923077,1.208791209,1.072360617,1.075526742,1.080518057,1.096654513,1.068396604,1.058785108,1.089889649
32,0.0096,0.04,0.1398,0.5615,2.4821,15.145,88.861,378.8,1573.9,,1.072916667,1.03,0.9527896996,1.125734639,1.071632892,1.084846484,1.050269522,1.046119324,1.034309677
64,0.0193,0.0726,0.263,1.1555,6.7461,36.018,202.79,842.81,3366.5,,0.9378238342,0.891184573,1.029657795,1.032886196,1.043047094,0.9598534066,1.001084866,0.9863195738,1.004723006
128,0.0373,0.137,0.5746,3.9791,16.866,79.953,503.04,2001.9,8035,,0.9946380697,1.005839416,0.973198747,1.04026036,0.9755128661,0.9201655973,0.9225906489,0.9481492582,0.9872682016
256,0.0801,0.2965,1.6877,8.2019,34.1,158.05,990.63,4299.8,17425,,0.8776529338,0.9740303541,0.9518871837,1.009485607,1.001554252,0.9476747865,0.9570475354,0.9042048467,0.927804878
512,0.1467,0.9757,4.0531,18.394,76.665,339.19,2086.5,9407.5,45172,,0.9481935924,0.9060161935,1.105795564,1.075459389,1.025357073,0.9914502196,1.007716271,1.051299495,1.078411405
1024,0.4703,2.7658,12.293,58.357,238.76,1071.9,6838.1,35751,154065,,0.9128216032,0.9716176152,1.003416579,1.002861696,1.021695426,0.9811549585,1.005249996,0.9909093452,1.017836627
2048,0.9468,5.536,24.622,117.05,482.03,2451.1,17973,83751,351350,,1.137938319,0.959158237,1.01908862,1.066552755,1.119681348,0.9523887234,0.960329383,1.00536113,0.9943247474
4096,2.0558,11.789,50.394,242.87,1000.9,5992.7,39697,175721,727236,,0.9235820605,0.9575875816,1.022959082,1.031580681,1.079228694,0.9222220368,0.9642542258,1.009338668,1.007173737
O2+ASan,,,,,,,,,,,,,,,,,,,
d\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
16,0.0135,0.0525,0.1965,0.6954,2.7096,11.226,60.273,236.76,1101.7,,3.214285714,2.386363636,2.173672566,2.095840868,1.718417047,1.637015866,1.506071964,1.460579889,1.642808148
32,0.0203,0.0736,0.2704,1.0771,4.8313,21.429,104.72,452.16,2149.4,,1.970873786,1.786407767,2.03003003,1.704002531,1.816346479,1.304260499,1.122064118,1.1410402,1.320351373
64,0.04,0.1345,0.5018,2.1569,9.6419,40.744,208.97,920.79,4259.2,,2.209944751,2.078825348,1.853028065,1.807205698,1.37026931,1.178525975,1.02935816,1.107677317,1.259224219
128,0.0795,0.2466,1.0517,4.7959,20.129,91.339,474.99,2170.1,9668.8,,2.142857143,1.789550073,1.880722461,1.158625855,1.2234243,1.241525078,1.023464771,1.143301196,1.218853606
256,0.1222,0.5324,2.2504,9.8272,41.358,192.27,969.39,4186.3,18593,,1.73826458,1.843490305,1.400809213,1.186902907,1.210962434,1.283682735,1.022477006,1.076750945,1.150058762
512,0.2525,1.2038,4.7479,22.394,95.513,412.41,2021.1,8618.2,47622,,1.815240834,1.361764706,1.059349829,1.132039228,1.21503899,1.226352255,0.9612384667,0.8713966492,0.9775834462
1024,0.8372,2.9467,12.327,58.247,241.09,1014.8,4789,26213,114911,,1.950151409,1.096528114,0.999351439,0.995266899,0.9883167992,0.9649139488,0.6966831539,0.7399367696,0.732790011
2048,1.5584,6.371,27.354,133.14,522.37,2155.3,13386,58546,241937,,1.446445146,1.199834272,1.090148254,1.066485101,0.9678537019,0.9232779301,0.7755504056,0.6953206651,0.6925228134
4096,3.6723,16.311,64.664,301.95,1169.1,5989.8,29711,126665,565303,,1.934112814,1.444857826,1.254369459,1.205196775,1.082299574,1.083812832,0.7761899786,0.7141608687,0.7717942312
The rest of datas are estimated under O2 optimization,,,,,,,,,,,,,,,,,,,
Arithmetic Operations,,,,,,,,,,,,,,,,,,,
Summary(Total time),,,,,,,,,,,,,,,,,,,
d\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
16,0.0059,0.026,0.0995,0.3646,1.4891,6.1104,24.868,98.937,397.15,,1.404761905,1.181818182,1.100663717,1.098854732,0.9443810249,0.8910405973,0.6213893053,0.6103454658,0.5922131759
32,0.0122,0.045,0.1691,0.6885,2.8743,11.662,47.275,190.65,759.3,,1.184466019,1.09223301,1.26951952,1.089226388,1.080604534,0.7097991479,0.5065468027,0.4811113635,0.4664291418
64,0.0232,0.0688,0.3193,1.3424,5.5562,22.79,91.806,368.23,1483.8,,1.281767956,1.063369397,1.179098966,1.124759112,0.7896255241,0.6592039801,0.4522240284,0.4429674719,0.4386825922
128,0.0373,0.1553,0.6385,2.8081,11.447,46.378,189.09,756.65,3024.6,,1.005390836,1.126995646,1.141809728,0.6783997294,0.6957393788,0.6303928232,0.4074337427,0.3986354776,0.3812825394
256,0.0755,0.2949,1.3547,5.8839,23.922,97.248,393.48,1579.5,6292.3,,1.073968706,1.021121884,0.8432617491,0.7106416899,0.7004362721,0.649272266,0.4150282677,0.4062604491,0.3892064081
512,0.1411,0.5874,2.6723,11.535,47.97,195.69,794.3,3171.6,12772,,1.014378145,0.664479638,0.5962426649,0.5831058538,0.6102354692,0.5819084719,0.3777703795,0.3206843207,0.2621833559
1024,0.2864,1.2055,5.4732,23.588,98.08,397.72,1617.1,6499.5,25942,,0.6671325413,0.4485915231,0.4437130118,0.4030483221,0.4020660818,0.3781686793,0.2352487635,0.1834669452,0.1654327128
2048,0.5608,2.3963,10.914,47.169,196.59,792.94,3222.1,12948,51870,,0.5205123445,0.4512891015,0.4349593496,0.3778356296,0.364244423,0.339676148,0.1866801854,0.1537767221,0.1484731907
4096,1.198,5.0987,22.999,94.878,392.61,1581.4,6430.5,25891,103396,,0.6309580239,0.4516520507,0.446140715,0.3786940209,0.3634604703,0.2861433793,0.1679946706,0.1459782817,0.1411640064
d=16\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
Seg 1(P=QKt),0.002,0.0095,0.0341,0.1217,0.4846,1.956,7.854,31.459,126.34,,,,,,,,,,
Seg 2(row max),0.0004,0.0015,0.0048,0.0133,0.048,0.1845,0.7376,2.9238,11.696,,,,,,,,,,
"Seg 3(softmax, exponential)",0.0017,0.0044,0.0143,0.0481,0.1856,0.7324,2.9885,11.94,47.93,,,,,,,,,,
Seg 4(normalization),0.0004,0.0014,0.0042,0.013,0.0474,0.1833,0.7315,2.9126,11.636,,,,,,,,,,
Seg 5(O=PV),0.0014,0.0081,0.0405,0.1692,0.7198,3.0427,12.493,49.616,199.32,,,,,,,,,,
d=32\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
Seg 1(P=QKt),0.0057,0.0207,0.0769,0.2787,1.1391,4.4943,18.192,73.854,290.85,,,,,,,,,,
Seg 2(row max),0.0005,0.0014,0.004,0.0131,0.0479,0.1859,0.727,2.9335,11.579,,,,,,,,,,
"Seg 3(softmax, exponential)",0.0013,0.0042,0.0131,0.0485,0.1845,0.7531,2.946,11.899,47.63,,,,,,,,,,
Seg 4(normalization),0.0005,0.0014,0.0038,0.0127,0.0478,0.1904,0.7226,2.9045,11.581,,,,,,,,,,
Seg 5(O=PV),0.0034,0.0162,0.071,0.3314,1.4605,6.017,24.646,98.999,397.26,,,,,,,,,,
d=64\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
Seg 1(P=QKt),0.0133,0.0368,0.1566,0.5956,2.3953,9.6838,38.443,153.72,618.31,,,,,,,,,,
Seg 2(row max),0.0005,0.0011,0.0047,0.0132,0.0482,0.1847,0.732,2.9247,11.657,,,,,,,,,,
"Seg 3(softmax, exponential)",0.0013,0.0035,0.0128,0.0475,0.183,0.7373,2.9629,11.913,47.618,,,,,,,,,,
Seg 4(normalization),0.0005,0.0012,0.0038,0.0127,0.0476,0.184,0.7232,2.9064,11.611,,,,,,,,,,
Seg 5(O=PV),0.0067,0.0252,0.1431,0.6776,2.8813,11.971,48.885,196.7,793.9,,,,,,,,,,
d=128\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
Seg 1(P=QKt),0.0233,0.0909,0.341,1.3737,5.4047,21.534,86.548,343.26,1367.9,,,,,,,,,,
Seg 2(row max),0.0004,0.0012,0.0039,0.0134,0.0482,0.1848,0.7319,2.9156,11.582,,,,,,,,,,
"Seg 3(softmax, exponential)",0.0012,0.0038,0.0132,0.0488,0.1858,0.7322,2.9686,11.848,47.524,,,,,,,,,,
Seg 4(normalization),0.0005,0.0013,0.0037,0.013,0.0473,0.182,0.7366,2.8849,11.524,,,,,,,,,,
Seg 5(O=PV),0.0116,0.0582,0.2806,1.3595,5.7611,23.701,98.014,395.4,1585.4,,,,,,,,,,
d=256\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
Seg 1(P=QKt),0.0509,0.1884,0.7656,3.0748,12.031,48.257,193.01,767.25,3066.3,,,,,,,,,,
Seg 2(row max),0.0004,0.0012,0.0042,0.0136,0.0483,0.1863,0.7292,2.9852,11.611,,,,,,,,,,
"Seg 3(softmax, exponential)",0.0011,0.0035,0.0127,0.0476,0.1863,0.7358,2.954,11.936,47.794,,,,,,,,,,
Seg 4(normalization),0.0005,0.0012,0.0037,0.013,0.0475,0.1832,0.7197,2.9307,11.601,,,,,,,,,,
Seg 5(O=PV),0.0227,0.1034,0.576,2.7255,11.577,47.938,195.98,793.65,3159.6,,,,,,,,,,
d=512\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
Seg 1(P=QKt),0.0969,0.3798,1.5259,6.0948,24.591,99.15,397.49,1574.4,6360,,,,,,,,,,
Seg 2(row max),0.0004,0.0012,0.0039,0.0135,0.0488,0.1903,0.7368,2.8942,11.606,,,,,,,,,,
"Seg 3(softmax, exponential)",0.0011,0.0035,0.0126,0.0495,0.187,0.7706,2.9809,11.861,47.8,,,,,,,,,,
Seg 4(normalization),0.0004,0.0011,0.0037,0.013,0.0477,0.1839,0.7261,2.8943,11.546,,,,,,,,,,
Seg 5(O=PV),0.0415,0.2055,1.1271,5.3549,23.062,95.232,392.14,1578.5,6329.5,,,,,,,,,,
d=1023\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
Seg 1(P=QKt),0.202,0.7858,3.1875,12.786,51.446,205.81,825.45,3304.1,13215,,,,,,,,,,
Seg 2(row max),0.0006,0.0012,0.0039,0.0134,0.0484,0.1854,0.7341,3.0011,12.104,,,,,,,,,,
"Seg 3(softmax, exponential)",0.0011,0.0036,0.0126,0.0482,0.186,0.7333,2.983,11.856,48.593,,,,,,,,,,
Seg 4(normalization),0.0004,0.001,0.0039,0.0129,0.0473,0.182,0.725,2.897,11.59,,,,,,,,,,
Seg 5(O=PV),0.0863,0.4126,2.2594,10.711,46.316,190.62,785.82,3174.7,12652,,,,,,,,,,
d=2048\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
Seg 1(P=QKt),0.396,1.5724,6.3657,25.609,102.96,410.37,1646.9,6581,26371,,,,,,,,,,
Seg 2(row max),0.0004,0.0011,0.004,0.0135,0.049,0.1845,0.7352,2.8967,11.633,,,,,,,,,,
"Seg 3(softmax, exponential)",0.001,0.0035,0.013,0.0523,0.187,0.7325,2.9918,11.899,47.631,,,,,,,,,,
Seg 4(normalization),0.0004,0.0012,0.0037,0.0132,0.0478,0.1818,0.7249,2.8874,11.603,,,,,,,,,,
Seg 5(O=PV),0.1672,0.8176,4.5152,21.461,93.231,381.56,1567.2,6347.6,25392,,,,,,,,,,
d=4096\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
Seg 1(S=QKt),0.8192,3.3253,13.537,51.534,205.06,817.55,3280.7,13136,52498,,,,,,,,,,
Seg 2(row max),0.0004,0.0012,0.0044,0.0134,0.0486,0.185,0.7305,2.9532,11.96,,,,,,,,,,
"Seg 3(softmax, exponential)",0.0011,0.0039,0.0144,0.0482,0.1877,0.7341,2.933,11.891,48.989,,,,,,,,,,
Seg 4(normalization),0.0005,0.0012,0.0039,0.013,0.0479,0.1833,0.7266,2.9028,11.705,,,,,,,,,,
Seg 5(O=PV),0.374,1.7578,9.4133,43.345,187.19,763.6,3146.1,12735,50815,,,,,,,,,,
Save/Load Operation,,,,,,,,,,,,,,,,,,,
Summary(Total time),,,,,,,,,,,,,,,,,,,
d\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
16,0.0026,0.0123,0.0451,0.1673,0.8014,3.5922,29.88,121.99,520.82,,0.619047619,0.5590909091,0.4988938053,0.5042194093,0.5082445459,0.5238275782,0.7466266867,0.7525601481,0.776624616
32,0.0059,0.0225,0.0733,0.2865,1.1409,12.102,73.069,311.7,1309.5,,0.572815534,0.5461165049,0.5503003003,0.4532510679,0.4289258995,0.7365794279,0.7829268815,0.7865849042,0.8044105903
64,0.0107,0.0423,0.1397,0.5592,5.2084,33.555,186.22,788.91,3251.8,,0.591160221,0.6537867079,0.5158788774,0.4685379137,0.7401975414,0.9705831309,0.9172947145,0.9490304109,0.9613883633
128,0.022,0.0723,0.5491,3.5723,15.173,78.059,455.41,1874.2,7604.9,,0.5929919137,0.5246734398,0.9819384835,0.8630203174,0.9222026378,1.061016719,0.9812755872,0.9874084611,0.9586773734
256,0.0558,0.1406,1.2788,7.5451,31.838,156.68,923.8,3812.4,15480,,0.7937411095,0.4868421053,0.7960161843,0.9112769786,0.9322167892,1.046067566,0.9743903468,0.9805807763,0.9575060308
512,0.084,0.7342,4.0918,19.424,78.476,364.71,2105.2,10107,49413,,0.6038820992,0.8305429864,0.912961021,0.9819027399,0.9983080818,1.084510393,1.001236564,1.021931022,1.014349058
1024,0.3596,2.2121,11.491,56.423,232.9,1061.5,7050.2,36875,161106,,0.8376426741,0.8231682358,0.9315768139,0.9641001982,0.9547429696,1.009318247,1.025632819,1.040902162,1.027376557
2048,0.7301,4.5421,23.835,116.21,475.54,2516.6,18107,87822,365527,,0.6776498979,0.8554021733,0.949904352,0.9308715155,0.8810864893,1.078050034,1.049073001,1.043016627,1.046288027
4096,1.6275,9.8056,49.801,236.7,968.4,6154.5,39963,183441,754872,,0.857165429,0.86859775,0.9660530349,0.9447593199,0.896500648,1.113614157,1.044020064,1.034274535,1.030608107
d=16\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
Seg 1(S=QKt),0.0012,0.0056,0.022,0.0706,0.3459,1.6145,18.005,73.119,308.95,,,,,,,,,,
Seg 2(P=f(S)),0.0003,0.0016,0.0059,0.0204,0.2049,0.8082,3.6684,15.686,64.237,,,,,,,,,,
Seg 3(O=PV),0.0012,0.0058,0.0193,0.0826,0.2592,1.1862,8.1789,32.949,132.36,,,,,,,,,,
d=32\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
Seg 1(S=QKt),0.0027,0.0104,0.0361,0.1361,0.55,7.8411,55.473,230.15,939.39,,,,,,,,,,
Seg 2(P=f(S)),0.0004,0.0014,0.0044,0.0174,0.0666,0.2839,1.3681,15.748,64.243,,,,,,,,,,
Seg 3(O=PV),0.0027,0.0107,0.0335,0.1366,0.5337,4.0005,16.349,65.5,289.39,,,,,,,,,,
d=64\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
Seg 1(S=QKt),0.005,0.0199,0.0693,0.2697,3.2007,25.267,152.42,621.07,2451.4,,,,,,,,,,
Seg 2(P=f(S)),0.0004,0.0014,0.0044,0.0174,0.0671,0.2754,1.3687,15.719,63.923,,,,,,,,,,
Seg 3(O=PV),0.0054,0.0209,0.0692,0.2762,1.9376,8.0218,32.651,151.47,719.39,,,,,,,,,,
d=128\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
Seg 1(S=QKt),0.0107,0.0356,0.2776,1.7724,7.6877,47.41,309.36,1233.5,5005,,,,,,,,,,
Seg 2(P=f(S)),0.0004,0.0012,0.0086,0.0174,0.0685,0.2794,1.405,15.683,64.131,,,,,,,,,,
Seg 3(O=PV),0.0109,0.0362,0.2668,1.783,7.4106,30.319,144.97,622.6,2519.2,,,,,,,,,,
d=256\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
Seg 1(S=QKt),0.0276,0.0701,0.4852,3.7099,15.869,91.885,616.13,2494,10006,,,,,,,,,,
Seg 2(P=f(S)),0.0004,0.0012,0.0041,0.0179,0.0719,0.2864,1.4303,15.871,64.76,,,,,,,,,,
Seg 3(O=PV),0.0281,0.0706,0.7939,3.8112,15.87,64.529,306.31,1295.4,5388.3,,,,,,,,,,
d=512\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
Seg 1(S=QKt),0.0457,0.2472,0.9739,7.5319,32.299,180.4,1242.1,5072.4,21974,,,,,,,,,,
Seg 2(P=f(S)),0.0004,0.0012,0.005,0.0183,0.0749,0.334,1.2661,15.668,64.645,,,,,,,,,,
Seg 3(O=PV),0.0384,0.4901,3.1108,11.858,46.121,183.85,862.21,5034.4,27354,,,,,,,,,,
d=1024\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
Seg 1(S=QKt),0.125,0.4973,2.0107,18.101,77.8,439.48,3506.2,15061,69954,,,,,,,,,,
Seg 2(P=f(S)),0.0003,0.0013,0.0049,0.0205,0.0841,0.3747,1.6875,15.637,64.11,,,,,,,,,,
Seg 3(O=PV),0.2391,1.7173,9.4761,38.3,154.98,622.79,3545,21782,91043,,,,,,,,,,
d=2048\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
Seg 1(S=QKt),0.2489,1.0093,4.9199,39.239,163.61,1218.5,10771,44315,182532,,,,,,,,,,
Seg 2(P=f(S)),0.0004,0.0014,0.0051,0.0219,0.0878,0.4032,1.6852,15.65,78.099,,,,,,,,,,
Seg 3(O=PV),0.4877,3.5365,18.917,76.904,311.73,1303,7342.8,43493,182815,,,,,,,,,,
d=4096\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
Seg 1(S=QKt),0.5304,2.3813,11.604,79.679,335.17,3418.7,22633,91800,377676,,,,,,,,,,
Seg 2(P=f(S)),0.0004,0.0014,0.0047,0.0215,0.0824,0.4237,1.7014,15.651,81.947,,,,,,,,,,
Seg 3(O=PV),1.0954,7.427,38.126,156.91,633.17,2737.2,17337,91650,376944,,,,,,,,,,
Attention w/o exp Operation,,,,,,,,,,,,,,,,,,,
d\N,16,32,64,128,256,512,1024,2048,4096,,,,,,,,,,
64,0.0146,0.0642,0.228,1.0964,6.8143,36.797,206.12,834.64,3370.4,,,,,,,,,,